/*! ViewportJS 0.3.0 | https://github.com/ryanfitzer/ViewportJS | Copyright (c) 2012 Ryan Fitzer | License: (http://www.opensource.org/licenses/mit-license.php) */(function(k,f){if(typeof define==="function"&&define.amd)define(f);else k.viewport=f()})(this,function(){function k(){var a={width:t(),height:i.clientHeight};o={width:a.width,height:a.height};a=0;for(var c=j.length;a<c;a++)j[a].state.subscribers&&j[a].update.call(j[a])}function f(){clearTimeout(p);p=setTimeout(function(){l||(l=true);k()},100)}function g(a,c){return function(){return c.apply(a,arguments)}}function u(a,c){return function(){var b=true,e=true,d=true,h=true,q=true,m=o;if(a.width){b=m.width>=
a.width[0];e=a.width[1]?m.width<=a.width[1]:true}if(a.height){d=m.height>=a.height[0];h=a.height[1]?m.height<=a.height[1]:true}if(a.condition)q=a.condition();if(c){console.log("\n"+a.name+"\n--------------");console.log("  wmin: "+(a.width&&a.width[0]>=0?a.width[0]:""));console.log("  wmax: "+(a.width&&a.width[1]>=0?a.width[1]:""));console.log("  hmin: "+(a.height&&a.height[0]>=0?a.height[0]:""));console.log("  hmax: "+(a.height&&a.height[1]>=0?a.height[1]:""));console.log("  cond: "+(a.condition?
a.condition:""))}return b&&e&&d&&h&&q}}function r(a,c){this.vps={};this.viewports=a;this.options=c||{};this.state={};this.state.channels={};this.state.tokenUid=-1;this.state.subscribers={};this.state.previous=n;this.state.present=n;this.state.initialUpdate=true;for(var b in s)this.options.hasOwnProperty(b)||(this.options[b]=s[b]);this.options.debug&&console.log("\nOptions:",this.options);b=0;for(var e=this.viewports.length;b<e;b++){var d=this.viewports[b];this.vps[d.name]=d;this.vps[d.name].test=
u(d,this.options.debug);if(this.options.modernize){d=this.vps[d.name];var h=window.Modernizr;h&&h.addTest&&h.addTest(d.name,d.test)}}return this}var p,i=document.documentElement,l=false,o={width:0,height:0},s={debug:false,modernize:false},n={name:"",width:[],height:[],condition:function(){},mediaExp:""},j=[],t=function(){var a,c,b=document.head||document.getElementsByTagName("head")[0],e=function(){return window.innerWidth},d=function(){return i.clientWidth};if(window.innerWidth===undefined)a=d;else{c=
document.createElement("body");c.style.cssText="overflow:scroll";a=document.createElement("div");a.id="viewportjs-div-test-element";a.style.cssText="position:absolute;top:-1000px;";a.innerHTML=["<style>","@media( width:"+i.clientWidth+"px ) {","#viewportjs-div-test-element {width:10px !important}}</style>"].join("");c.appendChild(a);i.insertBefore(c,b);a=a.offsetWidth===10?d:e;i.removeChild(c)}return a}();r.prototype={is:function(a){return this.current().name===a},current:function(){for(var a=n,c=
0,b=this.viewports.length;c<b;c++){var e=this.viewports[c],d=e.name;if(this.vps[d])if(this.vps[d].test())a=e}return a},matches:function(a){return this.vps[a]&&this.vps[a].test()},get:function(a){return this.vps[a]},subscribe:function(a,c){this.state.tokenUid+=1;this.state.channels[a]||(this.state.channels[a]=[]);this.state.channels[a].push({token:this.state.tokenUid,method:c});!l&&this.state.present.name===a&&c(true,this.state.present);return this.state.tokenUid},unsubscribe:function(a){var c,b;for(b in this.state.channels)if(c=
this.state.channels[b])for(var e=0,d=c.length;e<d;e++)c[e].token===a&&c.splice(e,1)},publish:function(a,c){var b=this.state.channels[a],e=b?b.length:0;if(b)for(;e--;)b[e].method(c,this.vps[a])},update:function(){if(this.state.initialUpdate||l){if(this.state.initialUpdate)this.state.initialUpdate=false;this.state.previous=this.state.present;this.state.present=this.current()}if(this.state.present!==this.state.previous){this.publish(this.state.previous.name,false);this.publish(this.state.present.name,
true)}}};if("addEventListener"in window){window.addEventListener("resize",f);window.addEventListener("orientationchange",f)}else window.attachEvent("onresize",f);k();return function(a,c){var b=new r(a,c);j.push(b);b.update();return{vps:b.vps,viewports:b.viewports,is:g(b,b.is),current:g(b,b.current),matches:g(b,b.matches),get:g(b,b.get),subscribe:g(b,b.subscribe),unsubscribe:g(b,b.unsubscribe)}}});
