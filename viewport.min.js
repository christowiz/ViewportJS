/*! ViewportJS 0.5.0 | https://github.com/ryanfitzer/ViewportJS | Copyright (c) 2012 Ryan Fitzer | License: (http://www.opensource.org/licenses/mit-license.php) */
!function(a,b){"function"==typeof define&&define.amd?define(b):a.viewport=b()}(this,function(){function a(){return{width:n(),height:j.clientHeight}}function b(){var b=a();k={width:b.width,height:b.height},d()}function c(){clearTimeout(h),h=setTimeout(function(){i||(i=!0),b()},100)}function d(){for(var a=0,b=m.length;b>a;a++)m[a][1].size=k,m[a][0].update.call(m[a][0])}function e(a,b){return function(){return b.apply(a,arguments)}}function f(a){return function(){var b=!0,c=!0,d=!0,e=!0,f=!0,g=k;return a.width&&(b=g.width>=a.width[0],c=a.width[1]?g.width<=a.width[1]:!0),a.height&&(d=g.height>=a.height[0],e=a.height[1]?g.height<=a.height[1]:!0),b&&c&&d&&e&&f}}function g(a){this.vps={},this.viewports=a,this.state={},this.state.channels={},this.state.tokenUid=-1,this.state.subscribers={},this.state.previous=l,this.state.present=l,this.state.initialUpdate=!0;for(var b=0,c=this.viewports.length;c>b;b++){var d=this.viewports[b];this.vps[d.name]=d,this.vps[d.name].test=f(d)}return this}var h,i=!1,j=document.documentElement,k={width:0,height:0},l={name:"",width:[],height:[]},m=[],n=function(){var a,b,c,d=document.head||document.getElementsByTagName("head")[0],e=function(){return window.innerWidth},f=function(){return j.clientWidth};return void 0===window.innerWidth?a=f:(c=document.createElement("body"),c.style.cssText="overflow:scroll",b=document.createElement("div"),b.id="viewportjs-div-test-element",b.style.cssText="position:absolute;top:-1000px;",b.innerHTML=["<style>","@media( width:"+j.clientWidth+"px ) {","#viewportjs-div-test-element {","width:10px !important","}","}","</style>"].join(""),c.appendChild(b),j.insertBefore(c,d),a=10===b.offsetWidth?f:e,j.removeChild(c)),a}();return g.prototype={is:function(a){var b=this.current();return b.name===a},current:function(){for(var a=l,b=0,c=this.viewports.length;c>b;b++){var d=this.viewports[b],e=d.name;this.vps[e]&&this.vps[e].test()&&(a=d)}return a},matches:function(a){return this.vps[a]&&this.vps[a].test()},subscribe:function(a,b){var c;if(!(a in this.vps)&&"*"!==a)throw new Error('The viewport "'+a+'" does not match any configured viewports.');return this.state.tokenUid=this.state.tokenUid+1,this.state.channels[a]||(this.state.channels[a]=[]),c=this.state.channels[a],c.push({token:this.state.tokenUid,method:b}),a===this.state.present.name&&b(!0,this.state.present),"*"===a&&b(this.state.present,this.state.previous),this.state.tokenUid},unsubscribe:function(a){var b;for(var c in this.state.channels)if(b=this.state.channels[c])for(var d=0,e=b.length;e>d;d++)b[d].token===a&&b.splice(d,1)},publish:function(a,b){var c=this.state.channels[a],d=c?c.length:0;if(c)for(;d--;)"*"===a?c[d].method(this.state.present,this.state.previous):c[d].method(b,this.vps[a])},update:function(){this.state.subscribers&&((this.state.initialUpdate||i)&&(this.state.initialUpdate&&(this.state.initialUpdate=!1),this.state.previous=this.state.present,this.state.present=this.current()),this.state.present!==this.state.previous&&(this.publish(this.state.previous.name,!1),this.publish(this.state.present.name,!0),this.publish("*")))}},"addEventListener"in window?(window.addEventListener("resize",c),window.addEventListener("orientationchange",c)):window.attachEvent("onresize",c),b(),function(a){var b,c=new g(a);return c.update(),b={size:k,vps:c.vps,viewports:c.viewports,is:e(c,c.is),current:e(c,c.current),matches:e(c,c.matches),subscribe:e(c,c.subscribe),unsubscribe:e(c,c.unsubscribe)},m.push([c,b]),b}});